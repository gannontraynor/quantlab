.PHONY: backend frontend dev install install-backend install-frontend format lint clean
# ============================
# QuantLab Monorepo Tooling
# ============================

PYTHON=python3
BACKEND_DIR=backend
FRONTEND_DIR=frontend
VENV=venv

# ----------------------------
# ENVIRONMENT
# ----------------------------

venv:
	$(PYTHON) -m venv $(VENV)
	@echo "Virtual environment created. Activate with:"
	@echo "   source venv/bin/activate"

install-backend:
	$(VENV)/bin/pip install -r $(BACKEND_DIR)/requirements.txt

install-frontend:
	cd $(FRONTEND_DIR) && npm install

install: venv install-backend install-frontend

# ----------------------------
# RUN
# ----------------------------

backend:
	./scripts/dev_backend.sh

frontend:
	cd $(FRONTEND_DIR) && npm run dev

dev:
	./scripts/dev_all.sh

# ----------------------------
# LINT & FORMAT
# ----------------------------

format:
	$(VENV)/bin/black backend

lint:
	$(VENV)/bin/ruff backend

# ----------------------------
# CLEAN
# ----------------------------

clean:
	rm -rf $(VENV)